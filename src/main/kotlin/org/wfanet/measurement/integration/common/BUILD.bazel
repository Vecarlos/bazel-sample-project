load("@rules_java//java:defs.bzl", "java_library")
load("@wfa_rules_kotlin_jvm//kotlin:defs.bzl", "kt_jvm_library")
load("//src/main/proto/wfa/measurement/internal/kingdom:all_protos.bzl", "KINGDOM_INTERNAL_PROTOS")  # buildifier: disable=bzl-visibility

package(
    default_testonly = True,
    default_visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration:__subpackages__",
        "//src/main/kotlin/org/wfanet/measurement/loadtest:__subpackages__",
        "//src/test/kotlin/org/wfanet/measurement/edpaggregator/resultsfulfiller:__subpackages__",
        "//src/test/kotlin/org/wfanet/measurement/integration:__subpackages__",
        "//src/test/kotlin/org/wfanet/measurement/loadtest:__subpackages__",
        "//src/test/kotlin/org/wfanet/panelmatch/integration:__subpackages__",
    ],
)

# java_library(
#     name = "kingdom_public_api_services",
#     visibility = ["//visibility:private"],
#     exports = [
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:accounts_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:api_keys_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:certificates_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:data_providers_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:event_group_metadata_descriptors_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:event_groups_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:exchange_step_attempts_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:exchange_steps_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:exchanges_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:measurement_consumers_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:measurements_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:model_lines_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:model_releases_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:model_rollouts_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:model_suites_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:populations_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:public_keys_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/api/v2alpha:requisitions_service",
#     ],
# )

# java_library(
#     name = "kingdom_system_api_services",
#     visibility = ["//visibility:private"],
#     exports = [
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/system/v1alpha:computation_log_entries_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/system/v1alpha:computation_participants_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/system/v1alpha:computations_service",
#         "//src/main/kotlin/org/wfanet/measurement/kingdom/service/system/v1alpha:requisitions_service",
#     ],
# )

# java_library(
#     name = "all_kingdom_services",
#     visibility = ["//visibility:private"],
#     exports = [
#         ":kingdom_public_api_services",
#         ":kingdom_system_api_services",
#     ] + KINGDOM_INTERNAL_PROTOS,
# )

# java_library(
#     name = "duchy_services",
#     visibility = ["//visibility:private"],
#     exports = [
#         "//src/main/kotlin/org/wfanet/measurement/duchy/deploy/gcloud/spanner/continuationtoken:service",
#         "//src/main/kotlin/org/wfanet/measurement/duchy/service/api/v2alpha:requisition_fulfillment_service",
#         "//src/main/kotlin/org/wfanet/measurement/duchy/service/internal/computationcontrol:async_computation_control_service",
#         "//src/main/kotlin/org/wfanet/measurement/duchy/service/internal/computations",
#         "//src/main/kotlin/org/wfanet/measurement/duchy/service/internal/computationstats:service",
#         "//src/main/kotlin/org/wfanet/measurement/duchy/service/system/v1alpha:computation_control_service",
#     ],
# )

kt_jvm_library(
    name = "in_process_kingdom",
    srcs = [
        "InProcessKingdom.kt",
    ],
    visibility = ["//visibility:public"],
    deps = [],
)

kt_jvm_library(
    name = "in_process_secure_computation_public_api",
    srcs = [
        "InProcessSecureComputationPublicApi.kt",
    ],
    visibility = ["//visibility:public"],
    deps = [],
)

kt_jvm_library(
    name = "configs",
    srcs = ["Configs.kt"],
    data = [
        "//src/main/k8s/testing/secretfiles:all_configs",
        "//src/main/k8s/testing/secretfiles:all_der_files",
        "//src/main/k8s/testing/secretfiles:all_root_certs.pem",
        "//src/main/k8s/testing/secretfiles:all_tink_keysets",
        "//src/main/proto/wfa/measurement/reporting/v2alpha:permissions_config.textproto",
        "//src/main/proto/wfa/measurement/securecomputation/controlplane/v1alpha:queues_config.textproto",
    ],
    deps = [],
)

kt_jvm_library(
    name = "synthetic_generation_specs",
    srcs = ["SyntheticGenerationSpecs.kt"],
    data = [
        "//src/main/k8s/testing/data:synthetic_generation_specs_large",
        "//src/main/k8s/testing/data:synthetic_generation_specs_small",
    ],
    visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration/common/reporting/v2:__subpackages__",
        "//src/main/kotlin/org/wfanet/measurement/loadtest/edpaggregator/tools:__subpackages__",
        "//src/test/kotlin/org/wfanet/measurement/integration:__subpackages__",
        "//src/test/kotlin/org/wfanet/measurement/loadtest:__subpackages__",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_duchy",
    srcs = [
        "InProcessDuchy.kt",
    ],
    visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration:__subpackages__",
        "//src/test/kotlin/org/wfanet/measurement/integration:__subpackages__",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_edp_simulator",
    srcs = [
        "InProcessEdpSimulator.kt",
    ],
    visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration:__subpackages__",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_population_requisition_fulfiller",
    srcs = [
        "InProcessPopulationRequisitionFulfiller.kt",
    ],
    visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration:__subpackages__",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_cmms_components",
    srcs = [
        "InProcessCmmsComponents.kt",
    ],
    visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration:__subpackages__",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_edp_aggregator_components",
    srcs = [
        "InProcessEdpAggregatorComponents.kt",
    ],
    visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration:__subpackages__",
    ],
    deps = [],
)

kt_jvm_library(
    name = "access_services_factory",
    srcs = ["AccessServicesFactory.kt"],
    visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration:__subpackages__",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_access",
    srcs = ["InProcessAccess.kt"],
    visibility = [
        "//src/main/kotlin/org/wfanet/measurement/integration:__subpackages__",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_life_of_a_measurement_integration_test",
    srcs = [
        "InProcessLifeOfAMeasurementIntegrationTest.kt",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_event_group_components",
    srcs = [
        "InProcessLifeOfAnEventGroupIntegrationTest.kt",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_reach_measurement_accuracy_test",
    srcs = [
        "InProcessReachMeasurementAccuracyTest.kt",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_measurement_system_prober_integration_test",
    srcs = [
        "InProcessMeasurementSystemProberIntegrationTest.kt",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_access_cli_integration_test",
    srcs = [
        "InProcessAccessCliIntegrationTest.kt",
    ],
    data = [
        "//src/main/k8s/testing/secretfiles:reporting_root.pem",
        "//src/main/k8s/testing/secretfiles:reporting_tls.key",
        "//src/main/k8s/testing/secretfiles:reporting_tls.pem",
    ],
    deps = [],
)

kt_jvm_library(
    name = "in_process_model_repository_cli_integration_test",
    srcs = [
        "InProcessModelRepositoryCliIntegrationTest.kt",
    ],
    data = [
        "//src/main/k8s/testing/secretfiles:all_root_certs.pem",
        "//src/main/k8s/testing/secretfiles:edp1_tls.key",
        "//src/main/k8s/testing/secretfiles:edp1_tls.pem",
        "//src/main/k8s/testing/secretfiles:kingdom_root.pem",
        "//src/main/k8s/testing/secretfiles:kingdom_tls.key",
        "//src/main/k8s/testing/secretfiles:kingdom_tls.pem",
        "//src/main/k8s/testing/secretfiles:mp1_tls.key",
        "//src/main/k8s/testing/secretfiles:mp1_tls.pem",
    ],
    deps = [],
)
