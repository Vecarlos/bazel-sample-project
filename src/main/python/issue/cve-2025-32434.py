import os
import torch
import pickle

class MaliciousModel(object):
    def __reduce__(self):
        return os.system, ('whoami',)

if __name__ == "__main__":
    model = MaliciousModel()
    filename = "malicious_model_simple.pth"
    with open(filename, 'wb') as f:
        pickle.dump(model, f)


    try:
        torch.load(filename, weights_only=True)
    finally:
        if os.path.exists(filename):
            os.remove(filename)
