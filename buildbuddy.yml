actions:
  - name: Build
    container_image: ubuntu-22.04
    triggers:
      push:
        branches:
          - "master"
      pull_request:
        branches:
          - "*"
    steps:
      - run: "bazel build --worker_quit_after_build //..."
  - name: Test 
    container_image: ubuntu-22.04
    triggers:
      push:
        branches:
          - "master"
      pull_request:
        branches:
          - "*"
    steps:
      - run: "azel test --worker_quit_after_build //src/test/..."
  - name: Coverage
    container_image: ubuntu-22.04
    triggers:
      push:
        branches:
          - "master"
      pull_request:
        branches:
          - "*"
    steps:
      - run: "bazel coverage --test_output=all --instrumentation_filter="-.*jacoco_exclusion" --combined_report=lcov //src/test/python/... | tee -a bazel_coverage.log || true"
 